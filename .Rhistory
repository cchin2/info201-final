Carbon Dioxide Emissions by State, 2005-2016`. You can find the data",
a("here", href = "https://www.eia.gov/environment/emissions/state/analysis/")),
p("We also used their data set of `State Energy Data System (SEDS): 1960-2016 (complete)`. You can find the data",
a("here", href = "https://www.eia.gov/state/seds/seds-data-complete.php?sid=US#Production"))
)
my_ui <- fluidPage(
titlePanel("Energy Sources and CO2 in the United States"),
h5("By Cameron Chin, Yilun Sun, and Chaichinda Siritantitam"),
navbarPage(
"My Application",
summary,
definitions_tabs,
question_one_tab,
question_two_tab,
question_three_tab,
references
)
)
setwd("C:/Users/hp/Desktop/INFO 201/info201-final")
source("data_wrangling.R")
# tab panels for definitions
page_one <- tabPanel(
"Crude Oil",
p(strong("Defintion:"), "most common form of fossil fuel made of a mixture of hydrocarbons, found in underground reservoirs."),
p(strong("Units:"), "thousands of barrels ")
)
page_two <- tabPanel(
"Natural Gas",
p(strong("Defintion:"), "naturally occurring gas made of primarily of methane and other hydrocarbons, found in natural gas
deposits made from hydrocarbons being heated/pressurized into gas."),
p(strong("Units:"), "millions of cubic feet")
)
page_three <- tabPanel(
"Fuel Ethanol",
p(strong("Defintion:"), "a renewable fuel that is commonly domestically produced or fermented from agricultural waste,
grain or corn. Ethanol fuel is also produced in a chemical extraction from ethylene (via hydration)."),
p(strong("Units:"), "thousand barrels")
)
page_four <- tabPanel(
"Biofuel",
p(strong("Defintion:"), "a renewable fuel that is produced through contemporary biological processes, such as agriculture and anaerobic
digestion"),
p(strong("Units:"), "trillion btu")
)
page_five <- tabPanel(
"CO2",
p(strong("Defintion:"), "a colorless gas made with one carbon atom and two oxygen atoms."),
p(strong("Units:"), "million metric tons"),
p(strong("CO2 per capita:"), "metric tons of carbon dioxide per person.")
)
page_six <- tabPanel(
"Renewable",
p(strong("Renewable"), "energy is generally defined as energy that is collected from resources which are naturally replenished on a human timescale,
such as sunlight, wind, rain, tides, waves, and geothermal heat.")
)
page_seven <- tabPanel(
"Nonrenewable",
p("A ", strong("non-renewable"), " resource (also called a finite resource) is a resource that does not renew itself at a sufficient rate for sustainable
economic extraction in meaningful human time-frames. ")
)
# tab panel with all defintions
definitions_tabs <- tabPanel(
"Definitions",
navbarPage(
title = NULL,
page_one,
page_two,
page_three,
page_four,
page_five,
page_six,
page_seven
)
)
# tab panel for question one
question_one_tab <- tabPanel(
"Energy vs Energy",
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "choice_x", label = "X Varaible",
choices = c("BioFuel", "Crude_Oil", "Fuel_Ethanol", "Natural_Gas"),
selected = "Crude_Oil"
),
selectInput(
inputId = "choice_y", label = "Y Variable",
choices = c("BioFuel", "Crude_Oil", "Fuel_Ethanol", "Natural_Gas"),
selected = "BioFuel"
),
radioButtons(inputId = "points_text", label = "Would you like to view points or see state names?",
choices = list("States" = 1, "Points" = 2),
selected = 1)
),
mainPanel(
plotOutput(outputId = "question_one")
)
)
)
# tab panel for question two
question_two_tab <- tabPanel(
"State Trends",
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "element1",
label = strong("Please select the renewable energy source from below"),
choices = selectThis1
),
selectInput(
inputId = "element2",
label = strong("Please select the non-renewable energy source from below"),
choices = selectThis2
),
sliderInput(
inputId = "slide_key",
label = "Please choose the percentage that you want to exclude from the pie chart",
min = 0,
max = 20,
value = 4
)
),
# shows the result from the widgets in tabs
mainPanel(
tabsetPanel(
id = "dataset",
tabPanel(
"Page 1",
textOutput(outputId = "message1"),
plotOutput("plot1"),
plotOutput("plot2")
)
)
)
)
)
# tab panel for question three
question_three_tab <- tabPanel(
"Energy Vs CO2",
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "choice_x_co2",
label = "X Variable",
choices = c("BioFuel", "Crude_Oil", "Fuel_Ethanol", "Natural_Gas"),
selected = "Crude_Oil"
),
radioButtons(
inputId = "points_text_co2", label = "Would you like to view points or see state names?",
choices = list("States" = 1, "Points" = 2),
selected = 1
)
),
mainPanel(
plotOutput(outputId = "question_three"),
textOutput(outputId = "message")
)
)
)
summary <- tabPanel(
"Introduction",
h3("Our Data"),
p("Our project is focused on the different production levels of energy sources in the United States.
These are used for energy in everyday life such as the gas for transportation and heating systems.
Some of these energy sources include crude oil, natural gas, biofuel, and ethanol. While these serve
similar purposes, they are different in their impacts on the environment. There are two main factors
that one should consider with these different options: cost and impact. For example, one key
difference is that crude oil releases a significant amount of carbon dioxide into the atmosphere.
Compared to natural gas, that is about 30% more carbon dioxide produced. The other is that crude oil
is considered cheaper than natural gas, giving reason to why most commercial cars are designed to use crude
oil. These two fuel options are better than burning coal but are still causes of significant air pollution and
are nonrenewable. We will also be examining renewable energy sources like biofuel and ethanol.  "),
h3("Importance"),
p("This domain is worth analyzing because we need to be aware of what kinds of impacts the fuel we choose to
use have on the environment. The issues of air pollution do not become something that is at the forefront of
everyone's minds since there are not clear incremental changes throughout our lives. For example, Washington's
emission check is discontinued in 2020 because people believe that we can maintain our clean air through
technology advancements for fuel-efficient cars. However, this shouldn't be the blanket solution to air
pollution as our focus must be on how much we are producing and whether we are making a conscious effort to
adapt to cleaner fuel.")
)
references <- tabPanel(
"References",
h3("Our Data"),
p("Our data was collected from the U.S. Energy Information Administration. We used their report of `Energy-Related
Carbon Dioxide Emissions by State, 2005-2016`. You can find the data",
a("here", href = "https://www.eia.gov/environment/emissions/state/analysis/")),
p("We also used their data set of `State Energy Data System (SEDS): 1960-2016 (complete)`. You can find the data",
a("here", href = "https://www.eia.gov/state/seds/seds-data-complete.php?sid=US#Production"))
)
my_ui <- fluidPage(
titlePanel("Energy Sources and CO2 in the United States"),
h5("By Cameron Chin, Yilun Sun, and Chaichinda Siritantitam"),
navbarPage(
"My Application",
summary,
definitions_tabs,
question_one_tab,
question_two_tab,
question_three_tab,
references
)
)
library("shiny", lib.loc="~/R/win-library/3.5")
source("data_wrangling.R")
# tab panels for definitions
page_one <- tabPanel(
"Crude Oil",
p(strong("Defintion:"), "most common form of fossil fuel made of a mixture of hydrocarbons, found in underground reservoirs."),
p(strong("Units:"), "thousands of barrels ")
)
page_two <- tabPanel(
"Natural Gas",
p(strong("Defintion:"), "naturally occurring gas made of primarily of methane and other hydrocarbons, found in natural gas
deposits made from hydrocarbons being heated/pressurized into gas."),
p(strong("Units:"), "millions of cubic feet")
)
page_three <- tabPanel(
"Fuel Ethanol",
p(strong("Defintion:"), "a renewable fuel that is commonly domestically produced or fermented from agricultural waste,
grain or corn. Ethanol fuel is also produced in a chemical extraction from ethylene (via hydration)."),
p(strong("Units:"), "thousand barrels")
)
page_four <- tabPanel(
"Biofuel",
p(strong("Defintion:"), "a renewable fuel that is produced through contemporary biological processes, such as agriculture and anaerobic
digestion"),
p(strong("Units:"), "trillion btu")
)
page_five <- tabPanel(
"CO2",
p(strong("Defintion:"), "a colorless gas made with one carbon atom and two oxygen atoms."),
p(strong("Units:"), "million metric tons"),
p(strong("CO2 per capita:"), "metric tons of carbon dioxide per person.")
)
page_six <- tabPanel(
"Renewable",
p(strong("Renewable"), "energy is generally defined as energy that is collected from resources which are naturally replenished on a human timescale,
such as sunlight, wind, rain, tides, waves, and geothermal heat.")
)
page_seven <- tabPanel(
"Nonrenewable",
p("A ", strong("non-renewable"), " resource (also called a finite resource) is a resource that does not renew itself at a sufficient rate for sustainable
economic extraction in meaningful human time-frames. ")
)
# tab panel with all defintions
definitions_tabs <- tabPanel(
"Definitions",
navbarPage(
title = NULL,
page_one,
page_two,
page_three,
page_four,
page_five,
page_six,
page_seven
)
)
# tab panel for question one
question_one_tab <- tabPanel(
"Energy vs Energy",
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "choice_x", label = "X Varaible",
choices = c("BioFuel", "Crude_Oil", "Fuel_Ethanol", "Natural_Gas"),
selected = "Crude_Oil"
),
selectInput(
inputId = "choice_y", label = "Y Variable",
choices = c("BioFuel", "Crude_Oil", "Fuel_Ethanol", "Natural_Gas"),
selected = "BioFuel"
),
radioButtons(inputId = "points_text", label = "Would you like to view points or see state names?",
choices = list("States" = 1, "Points" = 2),
selected = 1)
),
mainPanel(
plotOutput(outputId = "question_one")
)
)
)
# tab panel for question two
question_two_tab <- tabPanel(
"State Trends",
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "element1",
label = strong("Please select the renewable energy source from below"),
choices = selectThis1
),
selectInput(
inputId = "element2",
label = strong("Please select the non-renewable energy source from below"),
choices = selectThis2
),
sliderInput(
inputId = "slide_key",
label = "Please choose the percentage that you want to exclude from the pie chart",
min = 0,
max = 20,
value = 4
)
),
# shows the result from the widgets in tabs
mainPanel(
tabsetPanel(
id = "dataset",
tabPanel(
"Page 1",
textOutput(outputId = "message1"),
plotOutput("plot1"),
plotOutput("plot2")
)
)
)
)
)
# tab panel for question three
question_three_tab <- tabPanel(
"Energy Vs CO2",
sidebarLayout(
sidebarPanel(
selectInput(
inputId = "choice_x_co2",
label = "X Variable",
choices = c("BioFuel", "Crude_Oil", "Fuel_Ethanol", "Natural_Gas"),
selected = "Crude_Oil"
),
radioButtons(
inputId = "points_text_co2", label = "Would you like to view points or see state names?",
choices = list("States" = 1, "Points" = 2),
selected = 1
)
),
mainPanel(
plotOutput(outputId = "question_three"),
textOutput(outputId = "message")
)
)
)
summary <- tabPanel(
"Introduction",
h3("Our Data"),
p("Our project is focused on the different production levels of energy sources in the United States.
These are used for energy in everyday life such as the gas for transportation and heating systems.
Some of these energy sources include crude oil, natural gas, biofuel, and ethanol. While these serve
similar purposes, they are different in their impacts on the environment. There are two main factors
that one should consider with these different options: cost and impact. For example, one key
difference is that crude oil releases a significant amount of carbon dioxide into the atmosphere.
Compared to natural gas, that is about 30% more carbon dioxide produced. The other is that crude oil
is considered cheaper than natural gas, giving reason to why most commercial cars are designed to use crude
oil. These two fuel options are better than burning coal but are still causes of significant air pollution and
are nonrenewable. We will also be examining renewable energy sources like biofuel and ethanol.  "),
h3("Importance"),
p("This domain is worth analyzing because we need to be aware of what kinds of impacts the fuel we choose to
use have on the environment. The issues of air pollution do not become something that is at the forefront of
everyone's minds since there are not clear incremental changes throughout our lives. For example, Washington's
emission check is discontinued in 2020 because people believe that we can maintain our clean air through
technology advancements for fuel-efficient cars. However, this shouldn't be the blanket solution to air
pollution as our focus must be on how much we are producing and whether we are making a conscious effort to
adapt to cleaner fuel.")
)
references <- tabPanel(
"References",
h3("Our Data"),
p("Our data was collected from the U.S. Energy Information Administration. We used their report of `Energy-Related
Carbon Dioxide Emissions by State, 2005-2016`. You can find the data",
a("here", href = "https://www.eia.gov/environment/emissions/state/analysis/")),
p("We also used their data set of `State Energy Data System (SEDS): 1960-2016 (complete)`. You can find the data",
a("here", href = "https://www.eia.gov/state/seds/seds-data-complete.php?sid=US#Production"))
)
my_ui <- fluidPage(
titlePanel("Energy Sources and CO2 in the United States"),
h5("By Cameron Chin, Yilun Sun, and Chaichinda Siritantitam"),
navbarPage(
"My Application",
summary,
definitions_tabs,
question_one_tab,
question_two_tab,
question_three_tab,
references
)
)
shinyApp(ui = my_ui, server = my_server)
my_server <- function(input, output) {
# Question 1 graph
output$question_one <- renderPlot({
ggplot(data = correct_colnames_numeric) +
if (input$points_text == 1) {
geom_label(mapping = aes_string(
x = input$choice_x, y = input$choice_y,
label = "correct_colnames_numeric$State"
))
} else {
geom_point(mapping = aes_string(
x = input$choice_x, y = input$choice_y
))
}
})
# Question 2 graph
output$message1 <- renderText({
msg <- paste0("These graphs show the percentage share for production of ",
input$element1, " and of ",
input$element2,
" from different states in USA.")
msg
})
output$plot1 <- renderPlot({
if(input$element1 == "Bio Fuel"){
select_value1 <- "BioFuel"
}else {
select_value1 <- "Fuel_Ethanol"
}
show_pie <- select(correct_colnames_numeric, State, select_value1)
colnames(show_pie) <- c("States", "Percentage")
show_pie$Percentage <- show_pie$Percentage / sum(show_pie$Percentage) * 100
other_sum <- sum(show_pie$Percentage)
show_pie <- show_pie %>%
filter(show_pie$Percentage >= input$slide_key)
df <- data.frame("Others", other_sum - sum(show_pie$Percentage))
names(df)<-c("States","Percentage")
show_pie <- rbind(show_pie, df)
pie = ggplot(show_pie, aes(x = "", y = Percentage, fill = States)) +
geom_bar(stat = "identity", width = 1)
pie = pie + coord_polar("y", start = 0)
#if you want to change color, use this code below
#pie = pie + scale_fill_manual(values = c("#e00808", "#33658A", "#2F4858", "#F6AE2D", "#F26419", "#55ADE0", "#999999", "#cb3cd8", "#cb3cd6"))
pie = pie + geom_text(aes(label = paste0(round(show_pie$Percentage), "%")), position = position_stack(vjust = 0.5))
pie
})
output$plot2 <- renderPlot({
if(input$element2 == "Crude Oil"){
select_value1 <- "Crude_Oil"
}else {
select_value1 <- "Natural_Gas"
}
show_pie <- select(correct_colnames_numeric, State, select_value1)
colnames(show_pie) <- c("States", "Percentage")
show_pie$Percentage <- show_pie$Percentage / sum(show_pie$Percentage) * 100
other_sum <- sum(show_pie$Percentage)
show_pie <- show_pie %>%
filter(show_pie$Percentage >= input$slide_key)
df <- data.frame("Others", other_sum - sum(show_pie$Percentage))
names(df)<-c("States","Percentage")
show_pie <- rbind(show_pie, df)
pie = ggplot(show_pie, aes(x = "", y = Percentage, fill = States)) +
geom_bar(stat = "identity", width = 1)
pie = pie + coord_polar("y", start = 0)
#if you want to change color, use this code below
#pie = pie + scale_fill_manual(values = c("#e00808", "#33658A", "#2F4858", "#F6AE2D", "#F26419", "#55ADE0", "#999999", "#cb3cd8", "#cb3cd6"))
pie = pie + geom_text(aes(label = paste0(round(show_pie$Percentage), "%")), position = position_stack(vjust = 0.5))
pie
})
# Question 3 graph
output$question_three <- renderPlot({
ggplot(data = correct_colnames_numeric) +
if (input$points_text_co2 == 1) {
geom_label(mapping = aes_string(
x = input$choice_x_co2, y = "CO2",
label = "correct_colnames_numeric$State"
))
} else {
geom_point(mapping = aes_string(
x = input$choice_x, y = "CO2"
))
}
})
output$message <- renderText({
if(input$choice_x_co2 == "BioFuel") {
message <- paste(
"The plot shows the relationship between CO2 emission and ",
input$choice_x_co2, "of twenty states in 2016.", "The average amount of biofuel
for twenty states is", avg_bio_fuel, "trillion btu.", "The maximum amount is",
max_bio_fuel, "trillion btu.", "The minimum amount is", min_bio_fuel, "trillion btu.",
"The average amount of CO2 emission is", avg_CO2, "million metric tons.", "The maximum amount is",
max_CO2, "million metric tons.", "The minimum amount is", min_CO2, "million metric tons."
)}
else if(input$choice_x_co2 == "Crude_Oil"){
message <- paste(
"The plot shows the relationship between CO2 emission and ",
input$choice_x_co2, "of twenty states in 2016.", "The average amount of crude oil
for twenty states is", avg_crude_oil, "thousands of barrels.", "The maximum amount is",
max_crude_oil, "thousands of barrels.", "The minimum amount is", min_crude_oil, "thousands of barrels.",
"The average amount of CO2 emission is", avg_CO2, "million metric tons.", "The maximum amount is",
max_CO2, "million metric tons.", "The minimum amount is", min_CO2, "million metric tons."
)
}
else if(input$choice_x_co2 == "Fuel_Ethanol"){
message <- paste(
"The plot shows the relationship between CO2 emission and ",
input$choice_x_co2, "of twenty states in 2016.", "The average amount of fuel ethanol
for twenty states is", avg_fuel_ethanol, "thousands of barrels.", "The maximum amount is",
max_fuel_ethanol, "thousands of barrels.", "The minimum amount is", min_fuel_ethanol, "thousands of barrels.",
"The average amount of CO2 emission is", avg_CO2, "million metric tons.", "The maximum amount is",
max_CO2, "million metric tons.", "The minimum amount is", min_CO2, "million metric tons."
)
}
else {
message <- paste(
"The plot shows the relationship between CO2 emission and ",
input$choice_x_co2, "of twenty states in 2016.", "The average amount of natural gas
for twenty states is", avg_natural_gas, "millions of cubic feet.", "The maximum amount is",
max_natural_gas, "millions of cubic feet.", "The minimum amount is", min_natural_gas, "millions of cubic feet.",
"The average amount of CO2 emission is", avg_CO2, "million metric tons.", "The maximum amount is",
max_CO2, "million metric tons.", "The minimum amount is", min_CO2, "million metric tons."
)
}
})
}
